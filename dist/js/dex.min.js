function DexComponent(e,t){return e=e||{},t=t||{},this.registry={},this.debug=!1,this.config=e.hasOwnProperty("config")?dex.config.expandAndOverlay(e.config,t):dex.config.expandAndOverlay(e,t),dex.console.log("DexComponent Configuration",this.config),this.config.channel||(this.config.channel=(this.config.parent||"#parent")+"/"+(this.config.id||"unknown-id")),this.attr=function(e,t){return 0==arguments.length?this.config:1==arguments.length?this.config[e]:(2==arguments.length&&dex.object.setHierarchical(this.config,e,t,"."),this)},this.subscribe=function(e,t,n){if(3==arguments.length){var r=e.config.channel+"/"+t;return dex.console.log("subscribe to "+r),arguments.length<3?(dex.console.log("failed"),!1):bus.subscribe(r,n)}return!1},this.unsubscribe=function(e){return bus.unsubscribe(e)},this.publish=function(e,t){var n=e,r=t||e;1==arguments.length&&(n=e.type||"unknown-event");var o=this.config.channel+"/"+n;return dex.console.log("publish to "+o),bus.publish(o,r)},this.addListener=function(e,t,n){this.debug&&dex.console.debug("Registering Target: "+e+"="+t),this.registry.hasOwnProperty(e)||(this.registry[e]=[]),this.registry[e].push({target:t,method:n}),dex.console.trace(this.config.id,this.registry)},this.notify=function(e){var t,n;if(this.debug&&console.log("notify: "+e.type),!this.registry.hasOwnProperty(e.type))return this;for(e.source=this,t=this.registry[e.type],dex.console.trace("TARGETS: "+t.length),dex.console.trace(t),n=0;n<t.length;n++)t[n].method(e,t[n].target)},this.render=function(){console.log("Unimplemented routine: render()")},this.update=function(){console.log("Unimplemented routine: update()")},this}!function(e){"use strict";function t(){var t={},n=Function;return{publish:function(){var n,r,o,i=arguments,a=t[i[0]];a&&(n=a.length,r=i.length>1?Array.prototype.splice.call(i,1):[],setTimeout(function(){for(o=0;n>o;o+=1)a[o].apply(e,r);a=e=r=null},0))},subscribe:function(e,r){if("string"!=typeof e)throw"invalid or missing channel";if(!(r instanceof n))throw"invalid or missing callback";return t[e]||(t[e]=[]),t[e].push(r),{channel:e,callback:r}},unsubscribe:function(e,r){if(e.channel&&e.callback&&(r=e.callback,e=e.channel),"string"!=typeof e)throw"invalid or missing channel";if(!(r instanceof n))throw"invalid or missing callback";var o,i=t[e],a=i instanceof Array?i.length:0;for(o=0;a>o;o+=1)if(i[o]===r){i.splice(o,1);break}}}}"function"==typeof define&&define.amd?define("pubsub",t):"object"==typeof module&&module.exports?module.exports=t():e.PubSub=t()}(this);var jQuery=require("jquery");require("jquery-ui");var _=require("underscore"),dex=function(e){var t={};return t.version="0.7",t.range=function(e,t){for(var n=[],r=e+t,o=e;r>o;o++)n.push(o);return n},t.svg={},t.ui={jqueryui:{}},t.charts={d3:{map:{}},dygraphs:{},google:{},handlebars:{},threejs:{}},t}(jQuery,_);dex.array=function(){var e={};return e.slice=function(e,t,n){var r,o,i=[],a=dex.array.copy(e);if(arguments.length<2)return a;for(2==arguments.length?r=Array.isArray(t)?t:dex.range(t,a.length-t):arguments.length>2&&(r=Array.isArray(t)?t:dex.range(t,n)),o=0;o<r.length;o++)i.push(a[r[o]]);return i},e.indexOfById=function(e,t){for(var n=0;n<e.length;n++)if(e[n].id===t)return n;return-1},e.indexBands=function(e,t){dex.console.log("BANDS");var n,r,o,i,a;if(0>=t)o=[];else if(1==t)o=[Math.floor(t/2)];else if(2==t)o=[0,e.length-1];else{for(n=Math.max(1,Math.floor(e.length/(t-1))),r=Math.floor(e.length%(t-1)),o=[0],i=e.length-n,dex.console.log("TEST",e,t,n,r,i),a=n;i>=a;a+=n)r>0&&(a+=1,r-=1),o.push(a);o.push(e.length-1)}return dex.console.log("BANDS"),o},e.unique=function(e){var t,n,r={},o=[];for(t=0,n=e.length;n>t;t+=1)r.hasOwnProperty(e[t])||(o.push(e[t]),r[e[t]]=1);return o},e.extent=function(e,t){var n=getArrayValues(e,t),r=Math.max.apply(null,n),o=Math.min.apply(null,n);return dex.console.debug("EXTENT:",n,[o,r]),[o,r]},e.differenceDeprecated=function(e,t){var n,r,o=[],i=[];for(n=0;n<e.length;n++)o[e[n]]=!0;for(n=0;n<t.length;n++)o[t[n]]?delete o[t[n]]:o[t[n]]=!0;for(r in o)i.push(r);return i},e.selectiveJoinDeprecated=function(e,t,n){var r=":::";if(arguments.length>=3)r=n;else if(2===arguments.length)return dex.array.slice(e,t).join(n);throw"Invalid arguments."},e.copy=function(e){for(var t=[],n=0;n<e.length;n++)t.push(e[n]);return t},e}(),dex.color=function(){var e={};return e.toHex=function(e){if("#"===e.substr(0,1))return e;var t=/rgb\((\d+),(\d+),(\d+)\)/.exec(e),n=parseInt(t[1]),r=parseInt(t[2]),o=parseInt(t[3]),i=o|r<<8|n<<16;return"#"+i.toString(16)},e.colorScheme=function(e,t){if("1"==e)return d3.scale.category10();if("2"==e)return d3.scale.category20();if("3"==e)return d3.scale.category20b();if("4"==e)return d3.scale.category20c();if("HiContrast"==e)return d3.scale.ordinal().range(colorbrewer[e][9]);if(e in colorbrewer){var n,r=Math.pow(2,Math.ceil(Math.log(t)/Math.log(2)));for(r>128&&(r=256),n=r;n>=2;n--)if(colorbrewer[e][n])return d3.scale.ordinal().range(colorbrewer[e][n]);for(n=r;256>=n;n++)if(colorbrewer[e][n])return d3.scale.ordinal().range(colorbrewer[e][n]);return d3.scale.category20()}return d3.scale.category20()},e.shadeColor=function(e,t){var n=parseInt(e.substring(1,3),16),r=parseInt(e.substring(3,5),16),o=parseInt(e.substring(5,7),16);n=parseInt(n*(100+t)/100),r=parseInt(r*(100+t)/100),o=parseInt(o*(100+t)/100),n=255>n?n:255,r=255>r?r:255,o=255>o?o:255;var i=1==n.toString(16).length?"0"+n.toString(16):n.toString(16),a=1==r.toString(16).length?"0"+r.toString(16):r.toString(16),c=1==o.toString(16).length?"0"+o.toString(16):o.toString(16);return"#"+i+a+c},e.gradient=function(e){"r"==e.charAt(0)&&(e=colorToHex(e));var t;t="gradient"+e.substring(1),console.log("GradientId: "+t),console.log("BaseColor : "+e);var n=shadeColor(e,-20),r=d3.select("#gradients").selectAll("#"+t).data([t]).enter().append("radialGradient").attr("class","colorGradient").attr("id",t).attr("gradientUnits","objectBoundingBox").attr("fx","30%").attr("fy","30%");return r.append("stop").attr("offset","0%").attr("style","stop-color:#FFFFFF"),r.append("stop").attr("offset","40%").attr("style","stop-color:"+e),r.append("stop").attr("offset","100%").attr("style","stop-color:"+n),"url(#"+t+")"},e}(),dex.config=function(){var e={};return e.expand=function(e){var t,n={};if(!e)return e;for(var t in e)e.hasOwnProperty(t)&&(t&&t.indexOf(".")>-1?(n[t]=e[t],dex.object.setHierarchical(n,t,dex.object.clone(n[t]),"."),delete n[t]):n[t]=dex.object.isEmpty(e[t])?dex.object.clone(e[t]):dex.config.expand(e[t]));return n},e.expand_deprecate=function(e){var t,n,r;if(!e)return e;r=dex.object.clone(e);for(t in e)e.hasOwnProperty(t)&&(n=t?t.indexOf("."):-1,n>-1&&(dex.object.setHierarchical(r,t,dex.object.clone(r[t]),"."),delete r[t]));return r},e.expandAndOverlay=function(e,t){return dex.object.overlay(dex.config.expand(e),dex.config.expand(t))},e.font=function(e){var t={decoration:"none",family:"sans-serif",letterSpacing:"normal",size:14,style:"normal",weight:"normal",wordSpacing:"normal",variant:"normal"},n=dex.config.expandAndOverlay(e,t);return n},e.configureFont=function(e,t){return t&&(dex.config.setAttr(e,"font-family",t.family),dex.config.setAttr(e,"font-size",t.size),dex.config.setAttr(e,"font-weight",t.weight),dex.config.setAttr(e,"font-style",t.style),dex.config.setAttr(e,"text-decoration",t.decoration),dex.config.setAttr(e,"word-spacing",t.wordSpacing),dex.config.setAttr(e,"letter-spacing",t.letterSpacing),dex.config.setAttr(e,"variant",t.variant)),e},e.text=function(e){var t={font:dex.config.font(),x:0,y:0,textLength:void 0,lengthAdjust:void 0,transform:"",glyphOrientationVertical:void 0,text:void 0,dx:0,dy:0,writingMode:void 0,anchor:"start",fill:dex.config.fill(),format:void 0},n=dex.config.expandAndOverlay(e,t);return n},e.configureText=function(e,t){return t&&(dex.config.setAttr(e,"x",t.x),dex.config.setAttr(e,"y",t.y),dex.config.setAttr(e,"dx",t.dx),dex.config.setAttr(e,"dy",t.dy),dex.config.setStyle(e,"text-anchor",t.anchor),dex.config.configureFont(e,t.font),dex.config.setAttr(e,"textLength",t.textLength),dex.config.setAttr(e,"lengthAdjust",t.lengthAdjust),dex.config.setAttr(e,"transform",t.transform),dex.config.setAttr(e,"glyph-orientation-vertical",t.glyphOrientationVertical),dex.config.setAttr(e,"writing-mode",t.writingMode),dex.config.callIfDefined(e,"text",t.text),dex.config.configureFill(e,t.fill)),e},e.stroke=function(e){var t={width:1,color:"black",opacity:1,dasharray:"",transform:""},n=dex.config.expandAndOverlay(e,t);return n},e.configureStroke=function(e,t){return t&&(dex.config.setAttr(e,"stroke",t.color),dex.config.setStyle(e,"stroke-width",t.width),dex.config.setStyle(e,"stroke-opacity",t.opacity),dex.config.setStyle(e,"stroke-dasharray",t.dasharray),dex.config.setAttr(e,"transform",t.transform)),e},e.fill=function(e){var t={fillColor:"grey",fillOpacity:1},n=dex.config.expandAndOverlay(e,t);return n},e.configureFill=function(e,t){return t&&(dex.config.setStyle(e,"fill",t.fillColor),dex.config.setStyle(e,"fill-opacity",t.fillOpacity)),e},e.link=function(e){var t={fill:dex.config.fill(),stroke:dex.config.stroke(),transform:"",d:void 0,events:dex.config.events()},n=dex.config.expandAndOverlay(e,t);return n},e.configureLink=function(e,t){return t&&(dex.config.configureStroke(e,t.stroke),dex.config.configureFill(e,t.fill),dex.config.setAttr(e,"transform",t.transform),dex.config.setAttr(e,"d",t.d),dex.config.configureEvents(e,t.events)),e},e.rectangle=function(e){var t={width:50,height:50,x:0,y:0,rx:0,ry:0,stroke:dex.config.stroke(),opacity:1,color:d3.scale.category20(),transform:void 0,events:dex.config.events()};return e&&(t=dex.object.overlay(e,t)),t},e.configureRectangle=function(e,t){return t&&(dex.config.setAttr(e,"width",t.width),dex.config.setAttr(e,"height",t.height),dex.config.setAttr(e,"x",t.x),dex.config.setAttr(e,"y",t.y),dex.config.setAttr(e,"rx",t.rx),dex.config.setAttr(e,"ry",t.ry),dex.config.setAttr(e,"opacity",t.opacity),dex.config.setAttr(e,"fill",t.color),dex.config.setAttr(e,"transform",t.transform),dex.config.configureStroke(e,t.stroke),dex.config.configureEvents(e,t.events)),e},e.events=function(e){var t={mouseover:function(e){}},n=t;return e&&(n=dex.object.overlay(e,t)),n},e.configureEvents=function(e,t){if(t)for(var n in t)dex.config.setEventHandler(e,n,t[n]);return e},e.line=function(e){var t={start:dex.config.point(),end:dex.config.point(),stroke:dex.config.stroke()},n=dex.config.expandAndOverlay(e,t);return n},e.configureLine=function(e,t){return t&&(dex.config.setAttr(e,"x1",t.start.x),dex.config.setAttr(e,"y1",t.start.y),dex.config.setAttr(e,"x2",t.end.x),dex.config.setAttr(e,"y2",t.end.y),dex.config.configureStroke(e,t.stroke)),e},e.path=function(e){var t={fill:dex.config.fill(),stroke:dex.config.stroke()},n=dex.config.expandAndOverlay(e,t);return n},e.configurePath=function(e,t){return t&&(dex.config.configureFill(e,t.fill),dex.config.configureStroke(e,t.stroke)),e},e.getCallers=function(e){for(var t=[],n=e;n;n=n.caller)n.name&&t.push(n.name);return t.reverse()},e.getCallerString=function(e){return dex.config.getCallers(e).join("->")},e.setEventHandler=function(e,t,n){var r=dex.config.getCallerString(arguments.callee.caller);return e?dex.object.isFunction(e.on)?("undefined"!=typeof n?(dex.console.debug(r+": Set Event Handler: '"+t+"'='"+n+"'"),e.on(t,n)):dex.console.debug(r+=": Undefined Event Handler: '"+t+"'='"+n+"'"),e):(dex.console.warn(r+": dex.config.setEventHandler(eventType='"+t+"', eventHandler='"+n+"') : target node is missing function: node.on(eventType,eventHandler).  Node dump:",e),e):(dex.console.warn(r+": dex.config.setEventHandler(eventType='"+t+"eventHandler="+n+") : node is null."),e)},e.setAttr=function(e,t,n){var r=dex.config.getCallerString(arguments.callee.caller);return e?dex.object.isFunction(e.attr)?("undefined"!=typeof n?(dex.console.debug(r+": Set Attr: '"+t+"'='"+n+"'"),e.attr(t,dex.config.optionValue(n))):dex.console.debug(r+=": Undefined Attr: '"+t+"'='"+n+"'"),e):(dex.console.warn(r+": dex.config.setAttr(name='"+t+"', value='"+n+"') : target node is missing function: node.attr.  Node dump:",e),e):(dex.console.warn(r+": dex.config.setAttr(name='"+t+"value="+n+") : node is null."),e)},e.setStyle=function(e,t,n){var r=dex.config.getCallerString(arguments.callee.caller);return e?dex.object.isFunction(e.style)?("undefined"!=typeof n&&e&&dex.object.isFunction(e.style)?(dex.console.debug(r+": Set Style: name='"+t+"', Value Dump:",dex.config.optionValue(n)),e.style(t,dex.config.optionValue(n))):dex.console.debug(r+": Undefined Style: name='"+t+"', Value Dump:",n),e):(dex.console.warn(r+": dex.config.setStyle(name='"+t+"', value='"+n+"') : target node is missing function: node.style.  Node Dump:",e),e):(dex.console.warn(r+": dex.config.setAttr(name='"+t+"value="+n+") : node is null."),e)},e.optionValue=function(e){return function(t,n){return dex.object.isFunction(e)?e(t,n):e}},e.callIfDefined=function(e,t,n){return"undefined"!=typeof n?e[t](dex.config.optionValue(n)):e},e.point=function(e){var t={x:void 0,y:void 0};return e&&(t=dex.object.overlay(e,t)),t},e.configurePoint=function(e,t){return t&&e.attr("x",t.center.cx).attr("y",t.center.cy),e},e.configureShapeStyle=function(e,t){return t&&e.call(dex.config.configureStroke,t.stroke).attr("opacity",t.opacity).style("fill",t.color),e},e.circle=function(e){var t={cx:0,cy:0,r:10,fill:dex.config.fill(),stroke:dex.config.stroke(),transform:"",title:"",events:dex.config.events()};return e&&(t=dex.object.overlay(e,t)),t},e.configureCircle=function(e,t){return t&&(dex.config.setAttr(e,"r",t.r),dex.config.setAttr(e,"cx",t.cx),dex.config.setAttr(e,"cy",t.cy),dex.config.setAttr(e,"transform",t.transform),dex.config.setAttr(e,"title",t.title),dex.config.configureStroke(e,t.stroke),dex.config.configureFill(e,t.fill),dex.config.configureEvents(e,t.events)),e},e.configureAxis_deprecated=function(e){var t;if(e){var t=d3.svg.axis().ticks(e.tick.count).tickSubdivide(e.tick.subdivide).tickSize(e.tick.size.major,e.tick.size.minor,e.tick.size.end).tickPadding(e.tick.padding);dex.object.isFunction(e.tick.format)||t.tickFormat(e.tick.format),t.orient(e.orient).scale(e.scale)}else t=d3.svg.axis();return t},e.tick=function(e){var t={count:5,subdivide:3,size:{major:5,minor:3,end:5},padding:5,format:d3.format(",d"),label:dex.config.text()};return e&&(t=dex.object.overlay(e,t)),t},e.xaxis_deprecate=function(e){var t={scale:d3.scale.linear(),orient:"bottom",tick:this.tick(),label:dex.config.text()};return e&&(t=dex.object.overlay(e,t)),t},e.yaxis_deprecate=function(e){var t={scale:d3.scale.linear(),orient:"left",tick:this.tick(),label:dex.config.text({transform:"rotate(-90)"})};return e&&(t=dex.object.overlay(e,t)),t},e.callConditionally=function(e,t){void 0!==t&&e(t)},e.axis=function(e){var t={scale:dex.config.scale({type:"linear"}),orient:"bottom",ticks:void 0,tickValues:void 0,tickSize:void 0,innerTickSize:void 0,outerTickSize:void 0,tickPadding:void 0,tickFormat:void 0,tickSubdivide:void 0},n=dex.config.expandAndOverlay(e,t);return n},e.configureAxis=function(e,t){return t&&["scale","orient","ticks","tickValues","tickSize","innerTickSize","outerTickSize","tickPadding","tickFormat","tickSubdivide"].forEach(function(n){dex.config.callConditionally(e[n],t[n])}),e},e.createAxis=function(e){var t=dex.config.axis(e);return dex.config.configureAxis(d3.svg.axis(),t)},e.scale=function(e){var t={linear:dex.config.linearScale,sqrt:dex.config.sqrtScale,pow:dex.config.powScale,time:dex.config.timeScale,log:dex.config.logScale,ordinal:dex.config.ordinalScale,quantile:dex.config.quantileScale,quantize:dex.config.quantizeScale,identity:dex.config.identityScale,ordinal:dex.config.ordinalScale},n={type:"linear"},r=dex.config.expandAndOverlay(e,n);return t[r.type](r)},e.createScale=function(e){var t,n={linear:d3.scale.linear,sqrt:d3.scale.sqrt,pow:d3.scale.pow,time:d3.time.scale,log:d3.scale.log,ordinal:d3.scale.ordinal,quantile:d3.scale.quantile,quantize:d3.scale.quantize,identity:d3.scale.identity};return e?(t=n[e.type](),dex.config.configureScale(t,e)):t=d3.scale.linear(),t},e.linearScale=function(e){var t={type:"linear",domain:[0,100],range:[0,800],rangeRound:void 0,interpolate:void 0,clamp:void 0,nice:void 0},n=dex.config.expandAndOverlay(e,t);return n},e.powScale=function(e){var t={type:"pow",domain:[0,100],range:[0,800],rangeRound:void 0,interpolate:void 0,clamp:void 0,nice:void 0},n=dex.config.expandAndOverlay(e,t);return n},e.sqrtScale=function(e){var t={type:"sqrt",domain:[0,100],range:[0,800],rangeRound:void 0,interpolate:void 0,clamp:void 0,nice:void 0},n=dex.config.expandAndOverlay(e,t);return n},e.logScale=function(e){var t={type:"log",domain:[0,100],range:[0,800],rangeRound:void 0,interpolate:void 0,clamp:void 0,nice:void 0},n=dex.config.expandAndOverlay(e,t);return n},e.ordinalScale=function(e){var t={type:"ordinal",domain:void 0,range:void 0,rangeRoundBands:void 0,rangePoints:void 0,rangeBands:void 0},n=dex.config.expandAndOverlay(e,t);return n},e.timeScale=function(e){var t={type:"time",domain:void 0,range:void 0,rangeRound:void 0,interpolate:void 0,clamp:void 0,ticks:void 0,tickFormat:void 0},n=dex.config.expandAndOverlay(e,t);return n},e.quantileScale=function(e){var t={type:"quantile",domain:void 0,range:void 0},n=dex.config.expandAndOverlay(e,t);return n},e.quantizeScale=function(e){var t={type:"quantize",domain:void 0,range:void 0},n=dex.config.expandAndOverlay(e,t);return n},e.identityScale=function(e){var t={type:"identity",domain:void 0,range:void 0},n=dex.config.expandAndOverlay(e,t);return n},e.thresholdScale=function(e){var t={type:"threshold",domain:void 0,range:void 0},n=dex.config.expandAndOverlay(e,t);return n},e.configureScale=function(e,t){if(t)for(var n in t)dex.console.trace("ConfigureScale Property: '"+n+"'"),t.hasOwnProperty(n)&&"type"!==n&&void 0!==t[n]?(dex.console.trace("Property: '"+n+"'"),dex.config.callConditionally(e[n],t[n])):dex.console.debug("Missing Property: '"+n+"'");return e},e}(),dex.csv=function(){var e={};return e.csv=function(e,t){var n={header:e,data:t};return n},e.transpose=function(e){return{header:e.header,data:dex.matrix.transpose(e.data)}},e.getConnectionMatrix=function(e){var t,n,r,o,i,a,c,d,l=[],u=[],s={};for(a=dex.matrix.uniques(e.data),u=dex.matrix.flatten(a),s=new Array(a.length),t=0,o=0;t<a.length;t++)for(s[t]={},n=0;n<a[t].length;n++)s[t][u[o]]=o,o+=1;for(l=new Array(u.length),t=0;t<u.length;t++){for(r=new Array(u.length),n=0;n<u.length;n++)r[n]=0;l[t]=r}for(t=0;t<e.data.length;t++)for(n=1;n<e.header.length;n++)c=s[n-1][e.data[t][n-1]],d=s[n][e.data[t][n]],l[c][d]=1,l[d][c]=1;return i={header:u,connections:l}},e.createMap=function(e,t){var n,r,o,i={};for(n=0;n<e.data.length;n+=1)if(e.data[n].length===e.header.length){for(o={},r=0;r<e.header.length;r+=1)o[e.header[r]]=e.data[n][r];i[e.data[n][t]]=o}return i},e.toJson=function(e,t,n){var r,o,i,a=[];if(arguments.length>=3)return i={},i[e.header[n]]=e.data[t][n],i;if(2===arguments.length){var i={};for(o=0;o<e.header.length;o+=1)i[e.header[o]]=e.data[t][o];return i}if(1===arguments.length)for(r=0;r<e.data.length;r++){var i={};for(o=0;o<e.header.length;o++)i[e.header[o]]=e.data[r][o];a.push(i)}return a},e.toColumnArrayJson=function(e){var t,n,r={};if(1===arguments.length){for(n=0;n<e.header.length;n++)r[e.header[n]]=[];for(t=0;t<e.data.length;t++)for(n=0;n<e.header.length;n++)r[e.header[n]].push(e.data[t][n])}return r},e.copy=function(e){var t={header:dex.array.copy(e.header),data:dex.matrix.copy(e.data)};return t},e.toHierarchicalJson=function(e){function t(r,o){var i,a=[];if("undefined"==typeof r)return a;for(i in r)r.hasOwnProperty(i)&&a.push(n(i,e.header[o],t(r[i],o+1)));return a}function n(e,t,n){var r={name:e,category:t,children:n};return r}var r=dex.csv.connections(e);return t(r,0)},e.connections=function(e){var t,n={};for(t=0;t<e.data.length;t++)dex.object.connect(n,e.data[t]);return n},e.createRowMap=function(e,t){var n,r={};for(n=0;n<e.data.length;n++)e.data[n].length==e.header.length&&(r[e.data[n][t]]=e.data[n]);return r},e.columnSlice=function(e,t){var n={};return n.header=dex.array.slice(e.header,t),n.data=dex.matrix.columnSlice(e.data,t),n},e.getNumericColumnNames=function(e){var t,n,r,o={},i=[];for(t=0;t<e.header.length;t++)o[e.header[t]]=!0;for(n=0;n<e.data.length;n++)for(r=0;r<e.data[n].length&&r<e.header.length;r++)o[e.header[r]]&&!dex.object.isNumeric(e.data[n][r])&&(o[e.header[r]]=!1);for(r=0;r<e.header.length;r++)o[e.header[r]]&&i.push(e.header[r]);return i},e.guessTypes=function(e){var t=0,n=[];e.header.forEach(function(e){n.push({})});var r=e.header.length;e.data.forEach(function(e){for(t=0;r>t;t++){if(!n[t].notDate){var o=new Date(e[t]);isNaN(o.getTime())&&(dex.console.log("not date"+t),n[t].notDate=!0)}n[t].notNumber||isNaN(e[t])&&(n[t].notNumber=!0)}});var o=[];for(t=0;r>t;t++){var i=n[t];o.push(i.notDate?i.notNumber?"string":"number":"date")}return o},e.strictTypes=function(e){for(var t=dex.csv.guessTypes(e),n=0;n<t.length;n++)"date"==t[n]?e.data.forEach(function(t,r){dex.console.log("row["+r+"]="+t[r]),e.data[r][n]=new Date(e.data[r][n])}):"number"==t[n]&&e.data.forEach(function(t,r){dex.console.log("row["+r+"]="+t[r]),e.data[r][n]=new Double(e.data[r][n])});return e},e.getNumericIndices=function(e){var t,n,r={},o=[];for(t=0;t<e.header.length;t++)r[e.header[t]]=!0;for(t=1;t<e.data.length;t++)for(n=0;n<e.data[t].length&&n<e.header.length;n++)r[e.header[n]]&&!dex.object.isNumeric(e.data[t][n])&&(console.log("csv.header["+n+"]="+e.header[n]+" is not numeric due to csv.data["+t+"]["+n+"]="+e.data[t][n]),r[e.header[n]]=!1);for(t=0;t<e.header.length;t++)r[e.header[t]]&&o.push(t);return o},e.isColumnNumeric=function(e,t){var n;for(n=0;n<e.data.length;n++)if(!dex.object.isNumeric(e.data[n][t]))return!1;return!0},e.group=function(e,t){function n(n,r){var o,i;for(o=0;o<t.length;o++){if(i=e.header[t[o]],n[i]<r[i])return-1;if(n[i]>r[i])return 1}return 0}var r,o,i,a,c,d={},l=[];if(arguments<2)return e;for(r=0;r<e.data.length;r+=1){if(i=dex.array.slice(e.data[r],t),a=i.join(":::"),d[a])group=d[a];else{for(group={key:a,values:[],csv:dex.csv.csv(e.header,[])},o=0;o<i.length;o++)group.values.push({name:e.header[t[o]],value:i[o]});d[a]=group}group.csv.data.push(e.data[r])}for(c in d)d.hasOwnProperty(c)&&l.push(d[c]);return l.sort(n)},e.visitCells=function(e,t){var n,r;for(r=0;r<e.data.length;r++)for(n=0;n<e.header.length;n++)t(n,r,e.data[r][n])},e.longestWord=function(e){for(var t=0,n=0;n<e.data.length;n++)for(var r=0;r<e.data[n].length;r++)t<e.data[n][r].length&&(t=e.data[n][r].length);return t},e.numericSubset=function(e){return dex.csv.columnSlice(e,dex.csv.getNumericIndices(e))},e}(),dex.datagen=function(){var e={};return e.randomMatrix=function(e){var t,n,r=[],o=e.max-e.min;for(t=0;t<e.rows;t++){var i=[];for(n=0;n<e.columns;n++)i.push(Math.random()*o+e.min);r.push(i)}return r},e.identityCsv=function(e){var t={};return t.header=dex.datagen.identityHeader(e),t.data=dex.datagen.identityMatrix(e),t},e.identityMatrix=function(e){{var t,n,r=[];e.max-e.min}for(t=0;t<e.rows;t++){var o=[];for(n=0;n<e.columns;n++)o.push("R"+(t+1)+"C"+(n+1));r.push(o)}return r},e.identityHeader=function(e){return dex.range(1,e.columns).map(function(e){return"C"+e})},e}(),dex.json=function(){var e={};return e.toCsv=function(e,t){var n,r,o=[];if(2==arguments.length){if(Array.isArray(e))for(n=0;n<e.length;n++){var i=[];for(r=0;r<t.length;r++)i.push(e[n][t[r]]);o.push(i)}else{var i=[];for(r=0;r<t.length;r++)i.push(e[n][t[r]]);o.push(i)}return dex.csv.csv(t,o)}return dex.json.toCsv(e,dex.json.keys(e))},e.keys=function(e){var t,n,r={},o=[];if(Array.isArray(e))for(t=0;t<e.length;t++)for(n in e[t])r[n]=!0;else for(n in e)r[n]=!0;for(n in r)o.push(n);return o},e}(),dex.svg.Circle=function(e){var t={parent:"#CircleArea",id:"Circle","class":"Circle",width:"100%",height:"100%",csv:{header:["X","Y","P1","P2"],data:[[100,100,10,5],[200,200,20,10],[300,300,30,15]]},color:function(e){return console.log(e),o[e%o.length]}},n=dex.object.overlay(dex.config.expand(e),dex.config.expand(t)),r=new DexComponent(e,n),o=["red","green","blue"];return r.render=function(){r.update()},r.update=function(){var e=this,t=e.config,n=t.csv,r=dex.csv.numericSubset(n);console.dir(r);var o=document.querySelector(t.parent),i=o.querySelector("#"+t.id);i&&o.removeChild(i);for(var a=SVG(o).size(t.width,t.height).attr({id:t.id,"class":t["class"]}),c=0;c<r.data.length;c++)for(var d=2;d<r.header.length;d++)a.circle().radius(n.data[c][d]).x(n.data[c][0]).y(n.data[c][1]).attr({fill:t.color(d)})},r},dex.matrix=function(){var e={};return e.slice=function(e,t,n){var r,o=[];if(3===arguments.length)for(r=0;r<n.length;r++)o.push(dex.array.slice(e[n[r]]));else for(r=0;r<e.length;r++)dex.console.trace("RI: "+r,dex.array.slice(e[r],t)),o.push(dex.array.slice(e[r],t));return o},e.uniques=function(e){var t,n=[],r=dex.matrix.transpose(e),o=r.length;for(t=0;o>t;t+=1)n.push(dex.array.unique(r[t]));return n},e.transpose=function(e){var t,n,r=[];if(!e||e.length<=0||!e[0]||e[0].length<=0)return[];for(n=e[0].length,t=0;n>t;t++)r.push(e.map(function(e){return e[t]}));return r},e.columnSlice=function(e,t){var n,r,o=[];if(2!=arguments.length)return e;if(r=dex.matrix.transpose(e),Array.isArray(t))for(n=0;n<t.length;n+=1)o.push(r[t[n]]);else o.push(r[t]);return dex.matrix.transpose(o)},e.flatten=function(e){var t,n,r=[];for(t=0;t<e.length;t++)for(n=0;n<e[t].length;n++)r.push(e[t][n]);return r},e.extent=function(e,t){var n=e;if(2===arguments.length){n=dex.matrix.flatten(dex.matrix.slice(e,t));var r=Math.max.apply(null,n),o=Math.min.apply(null,n);return[o,r]}},e.combine=function(e,t){var n,r,o,i=[];for(n=0;n<e.length;n++)for(r=0;r<e[n].length;r++)for(o=0;o<t[n].length;o++)i.push([e[n][r],t[n][o],r,o]);return i},e.copy=function(e){var t,n,r=[];for(t=0;t<e.length;t++)for(r[t]=[],n=0;n<e[t].length;n++)r[t].push(e[t][n]);return r},e.addIndex=function(e){for(var t=dex.matrix.copy(e),n=0;n<e.length;n++)t[n].unshift(n+1);return dex.console.trace("Original Matrix:",e,"Indexed Matrix",t),t},e.isColumnNumeric=function(e,t){var n;for(n=1;n<e.length;n++)if(!dex.object.isNumeric(e[n][t]))return!1;return!0},e.max=function(e,t){var n,r=e[0][t];if(dex.matrix.isColumnNumeric(e,t))for(r=parseFloat(e[0][t]),n=1;n<e.length;n++)r<parseFloat(e[n][t])&&(r=parseFloat(e[n][t]));else for(n=1;n<e.length;n++)r<e[n][t]&&(r=e[n][t]);return r},e.min=function(e,t){var n,r=e[0][t];if(dex.matrix.isColumnNumeric(e,t))for(r=parseFloat(e[0][t]),n=1;n<e.length;n++)r>parseFloat(e[n][t])&&(r=parseFloat(e[n][t]));else for(n=1;n<e.length;n++)r>e[n][t]&&(r=e[n][t]);return r},e}(),dex.object=function(){var e={};return e.keys=function t(e){var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(n);return t},e.clone=function(e){var t,n,r;if(null==e||"object"!=typeof e)return e;if(e instanceof Date){var o=new Date;return o.setTime(e.getTime()),o}if(e instanceof Array){var o=[];for(t=0,r=e.length;r>t;t++)o[t]=dex.object.clone(e[t]);return o}if(dex.object.isElement(e)||dex.object.isNode(e))return e;if(e instanceof Object){var o={};for(n in e)e.hasOwnProperty(n)&&(o[n]=dex.object.clone(e[n]));return o}throw new Error("Unable to copy obj! Its type isn't supported.")},e.isEmpty=function(e){if(!e||e instanceof Array)return!0;if("object"==typeof e)for(var t in e)if(e.hasOwnProperty(t))return!1;return!0},e.overlay=function n(e,t){var r,n=dex.object.clone(t);if("undefined"!==e)for(r in e)n[r]="object"!=typeof e[r]||null==n[r]||e[r]instanceof Array?e[r]:dex.object.overlay(e[r],n[r]);return n},e.isNode=function(e){return"object"==typeof Node?e instanceof Node:e&&"object"==typeof e&&"number"==typeof e.nodeType&&"string"==typeof e.nodeName},e.isElement=function(e){return"object"==typeof HTMLElement?e instanceof HTMLElement:e&&"object"==typeof e&&1===e.nodeType&&"string"==typeof e.nodeName},e.contains=function(e,t){for(var n=e.length;n--;)if(e[n]===t)return!0;return!1},e.isFunction=function(e){return"function"==typeof e},e.visit=function(e,t){var n;t(e);for(n in e)e.hasOwnProperty(n)&&"object"==typeof e[n]&&dex.object.visit(e[n],t)},e.connect=function(e,t){return!t||t.length<=0?this:(e[t[0]]||(e[t[0]]={}),dex.object.connect(e[t[0]],t.slice(1)),this)},e.isNumeric=function(e){return!isNaN(parseFloat(e))&&isFinite(e)},e.setHierarchical=function(e,t,n,r){return null==e&&(e={}),"object"!=typeof e?e:4==arguments.length?dex.object.setHierarchical(e,t.split(r),n):(1===t.length?e[t[0]]=n:(t[0]in e||(e[t[0]]={}),dex.object.setHierarchical(e[t[0]],t.splice(1),n)),e)},e}(),dex.ui.SqlQuery=function(e){var t={parent:"#SqlQuery",id:"SqlQuery","class":"SqlQuery",query:"select * from dex;",csv:{header:["X","Y","Z"],data:[[0,0,0],[1,1,1],[2,2,2]]}},n=new DexComponent(e,t),r=window.SQL,o=new r.Database;return n.render=function(){var e="create table dex("+csv.header.map(function(e,t){var n=e.trim();return"'"+n+"' "+(dex.csv.isColumnNumeric(csv,t)?"float":"text")}).join(",")+")";console.log("CREATESTR: "+e),o.exec("drop table if exists dex;"),o.exec(e);var t="BEGIN;"+csv.data.map(function(e){var t="insert into dex values("+e.map(function(e){return"'"+e.replace("'","")+"'"}).join(",")+");";return t}).join("")+"COMMIT;";console.log(t),o.exec(t),n.update()},n.query=function(e){var t=[],r=n.attr("query");e&&e.length>0&&(r=e),console.log("QUERY: "+r),t.header=[],t.data=[];var i=o.exec(r);return console.log("RS:"),console.dir(i),t.header=i[0].columns.map(function(e){return e.trim()}),t.data=i[0].values,console.log(t),t},n.update=function(){},n},dex.ui.Table=function(e){var t={parent:"#Table",id:"Table","class":"Table",csv:{header:["X","Y","Z"],data:[[0,0,0],[1,1,1],[2,2,2]]}},n=new DexComponent(e,t);return n.render=function(){n.update()},n.update=function(){var e=this,t=e.config,n=t.csv;d3.selectAll("#"+t.id).remove();var r=d3.select(t.parent).append("table").attr("height","100%").attr("width","100%").attr("border",1).attr("class",t["class"]).attr("id",t.id),o=r.append("thead"),i=r.append("tbody");o.append("tr").selectAll("th").data(n.header).enter().append("th").text(function(e){return e});{var a=i.selectAll("tr").data(n.data).enter().append("tr");a.selectAll("td").data(function(e){return n.header.map(function(t,n){return{column:n,value:e[n]}})}).enter().append("td").html(function(e){return e.value})}},n},dex.ui.TypesTable=function(e){var t={parent:"#Table",id:"Table","class":"Table",csv:{header:["X","Y","Z"],data:[[0,0,0],[1,1,1],[2,2,2]]}},n=new DexComponent(e,t);return n.render=function(){n.update()},n.update=function(){var e=this,t=e.config,n=dex.csv.guessTypes(t.csv),r=dex.csv.copy(t.csv);d3.selectAll("#"+t.id).remove();var o=d3.select(t.parent).append("table").attr("height","100%").attr("width","100%").attr("border",1).attr("class",t["class"]).attr("id",t.id),i=o.append("thead"),a=o.append("tbody");i.append("tr").selectAll("th").data(r.header).enter().append("th").text(function(e,t){return e+" ("+n[t]+")"});{var c=a.selectAll("tr").data(r.data).enter().append("tr");c.selectAll("td").data(function(e){return r.header.map(function(t,n){return{column:n,value:e[n]}})}).enter().append("td").html(function(e){return e.value})}},n},dex.console=function(){var e={},t={TRACE:5,DEBUG:4,NORMAL:3,WARN:2,FATAL:1,NONE:0},n=t.NORMAL;return e.logWithLevel=function(e,t){if(dex.console.logLevel()>=e)for(i=0;i<t.length;i++)"object"==typeof t[i]?console.dir(t[i]):console.log(t[i]);return this},e.trace=function(){return dex.console.logWithLevel(t.TRACE,arguments)},e.debug=function(){return dex.console.logWithLevel(t.DEBUG,arguments)},e.log=function(){return dex.console.logWithLevel(t.NORMAL,arguments)},e.warn=function(){return dex.console.logWithLevel(t.WARN,arguments)},e.fatal=function(){return dex.console.logWithLevel(t.FATAL,arguments)},e.logLevel=function(e){return arguments.length?n=t[e]:n},e.logLevels=function(){return t},e}();